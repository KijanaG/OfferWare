{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst dotenv = require('dotenv');\n\nconst AWS = require('aws-sdk');\n\nconst sgMail = require('@sendgrid/mail');\n\nconst short = require('short-uuid'); // const NodeGeocoder = require('node-geocoder');\n// const geocoder = NodeGeocoder({\n//     apiKey: 'AIzaSyAfTmvVvLL6-SdQy6O5GcgiG3vxoDDEhic',\n//     formatter: null\n// })\n\n\ndotenv.config();\nsgMail.setApiKey(process.env.sendGridKey);\nAWS.config.update({\n  region: 'us-west-2',\n  credentials: {\n    accessKeyId: process.env.accessKeyId,\n    secretAccessKey: process.env.secretAccessKey\n  }\n});\nvar docClient = new AWS.DynamoDB.DocumentClient();\nmodule.exports = {\n  // getCoords: async (street, city, zipCode, state) => {\n  //     let res =  await geocoder.geocode(`${street} ${city}, ${state} ${zipCode}`)\n  //     console.log(res)\n  //     return \"HELLLO\"\n  // },\n  sendVoucherLink: async (shop, email, title, variant_title, id) => {\n    const p_params = {\n      TableName: 'Shopify_Products',\n      FilterExpression: 'shopOrigin = :shop and title = :t',\n      ExpressionAttributeValues: {\n        ':shop': shop,\n        ':t': title\n      }\n    };\n    let awsRequest = await docClient.scan(p_params);\n    let result = await awsRequest.promise();\n\n    if (result.Items.length > 0) {\n      console.log(\"Received Item\");\n      const transaction_id = short.generate();\n      const v_code = Date.now().toString();\n      let variantPurchased = null;\n\n      for (let variant of result.Items[0].variants) {\n        if (variant.title == variant_title) {\n          variantPurchased = variant;\n          variantPurchased.variant_title = variant_title;\n          variantPurchased.title = title;\n        }\n      } //Check if transaction has already been made due to faulty webhook\n\n\n      const check_params = {\n        TableName: 'Deal_Transactions',\n        FilterExpression: 'order_id = :id and variant_title =:v',\n        ExpressionAttributeValues: {\n          ':id': id,\n          ':v': variant_title.length > 0 ? variant_title : null\n        }\n      };\n      let awsTReq = await docClient.scan(check_params);\n      let tResult = await awsTReq.promise();\n      if (tResult.Items.length > 0) return; //Get variant from variant array & add to transaction\n\n      const t_params = {\n        TableName: 'Deal_Transactions',\n        Item: _objectSpread({\n          transaction_id,\n          order_id: id,\n          email,\n          shopOrigin: shop\n        }, variantPurchased, {\n          time_purchased: Date.now(),\n          v_code: v_code.substring(v_code.length - 5),\n          time_redeemed: null,\n          rating: null,\n          review: null,\n          status: 'PURCHASED',\n          vendor: result.Items[0].id\n        })\n      };\n      awsRequest = await docClient.put(t_params);\n      let res = await awsRequest.promise();\n      if (Object.keys(res).length > 0) return false;\n      console.log(\"Created Transaction\");\n      let link = `https://scottsdeal.offerware.co/${transaction_id}/redeem/${result.Items[0].id}?shop=${shop}`; // Eventually replace variant in email for more targerted content\n      // if (!result.Items[0].email) return //Temporary while developing\n\n      let sendEmail = result.Items[0].email.replace('{{Auto-Generated Link}}', link);\n      console.log(sendEmail);\n      const msg = {\n        to: email,\n        from: 'scottsdeal@offerware.co',\n        subject: `Your Voucher Link for: ${variant_title}.`,\n        text: sendEmail\n      };\n      let resMail = await sgMail.send(msg);\n      return true;\n    }\n  },\n  updateProductInDB: async (title, handle, shop, descriptionHtml, images, variants) => {\n    console.log(\"UPDATING\");\n    const title_params = {\n      TableName: 'Shopify_Products',\n      FilterExpression: 'shopOrigin = :shop and title = :t',\n      ExpressionAttributeValues: {\n        ':shop': shop,\n        ':t': title\n      }\n    };\n    let awsRequest = docClient.scan(title_params);\n    let result = await awsRequest.promise();\n    let updatedProduct = null; // First check If title did not change & update db if found\n\n    if (result.Items.length > 0) {\n      updatedProduct = _objectSpread({}, result.Items[0], {\n        title,\n        handle,\n        descriptionHtml\n      });\n      await updateDB(updatedProduct, images, variants);\n      return;\n    } else {\n      // Check if handle did not change & update db if found\n      const handle_params = {\n        TableName: 'Shopify_Products',\n        FilterExpression: 'shopOrigin = :shop and handle = :h',\n        ExpressionAttributeValues: {\n          ':shop': shop,\n          ':h': handle\n        }\n      };\n      awsRequest = docClient.scan(handle_params);\n      result = await awsRequest.promise();\n      if (result.Items.length > 0) updatedProduct = _objectSpread({}, result.Items[0], {\n        title,\n        handle,\n        descriptionHtml\n      });\n      await updateDB(updatedProduct, images, variants); // else do nothing because Shopify Admin did not subscribe\n      // to Voucher capabilities with this products\n\n      return;\n    }\n  }\n};\n\nasync function updateDB(updatedProduct, images, variants) {\n  let newImages = [];\n\n  for (let image of images) newImages.push({\n    'altText': image.alt,\n    'originalSrc': image.src\n  });\n\n  updatedProduct.images = newImages;\n  let newVariants = [];\n\n  for (let variant of variants) newVariants.push({\n    'title': variant.title,\n    'price': variant.price,\n    'compareAtPrice': variant.compare_at_price\n  });\n\n  updatedProduct.variants = newVariants;\n  let updated_params = {\n    TableName: 'Shopify_Products',\n    Item: updatedProduct\n  };\n  let awsReq = await docClient.put(updated_params);\n  let res = awsReq.promise();\n  return;\n}","map":{"version":3,"sources":["/Users/kjgarrett/Desktop/Deals/shopifyPlugin/api.js"],"names":["dotenv","require","AWS","sgMail","short","config","setApiKey","process","env","sendGridKey","update","region","credentials","accessKeyId","secretAccessKey","docClient","DynamoDB","DocumentClient","module","exports","sendVoucherLink","shop","email","title","variant_title","id","p_params","TableName","FilterExpression","ExpressionAttributeValues","awsRequest","scan","result","promise","Items","length","console","log","transaction_id","generate","v_code","Date","now","toString","variantPurchased","variant","variants","check_params","awsTReq","tResult","t_params","Item","order_id","shopOrigin","time_purchased","substring","time_redeemed","rating","review","status","vendor","put","res","Object","keys","link","sendEmail","replace","msg","to","from","subject","text","resMail","send","updateProductInDB","handle","descriptionHtml","images","title_params","updatedProduct","updateDB","handle_params","newImages","image","push","alt","src","newVariants","price","compare_at_price","updated_params","awsReq"],"mappings":"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","sourcesContent":["const dotenv = require('dotenv');\nconst AWS = require('aws-sdk');\nconst sgMail = require('@sendgrid/mail');\nconst short = require('short-uuid');\n// const NodeGeocoder = require('node-geocoder');\n// const geocoder = NodeGeocoder({\n//     apiKey: 'AIzaSyAfTmvVvLL6-SdQy6O5GcgiG3vxoDDEhic',\n//     formatter: null\n// })\ndotenv.config();\nsgMail.setApiKey(process.env.sendGridKey);\nAWS.config.update({\n    region: 'us-west-2', credentials: {\n        accessKeyId: process.env.accessKeyId,\n        secretAccessKey: process.env.secretAccessKey\n    }\n});\nvar docClient = new AWS.DynamoDB.DocumentClient();\n\n\nmodule.exports = {\n    // getCoords: async (street, city, zipCode, state) => {\n    //     let res =  await geocoder.geocode(`${street} ${city}, ${state} ${zipCode}`)\n    //     console.log(res)\n    //     return \"HELLLO\"\n    // },\n    sendVoucherLink: async (shop, email, title, variant_title, id) => {\n        const p_params = {\n            TableName: 'Shopify_Products',\n            FilterExpression: 'shopOrigin = :shop and title = :t',\n            ExpressionAttributeValues: { ':shop': shop, ':t': title }\n        }\n        let awsRequest = await docClient.scan(p_params);\n        let result = await awsRequest.promise();\n        if (result.Items.length > 0) {\n            console.log(\"Received Item\")\n            const transaction_id = short.generate();\n            const v_code = Date.now().toString();\n            let variantPurchased = null;\n            for (let variant of result.Items[0].variants) {\n                if (variant.title == variant_title) {\n                    variantPurchased = variant\n                    variantPurchased.variant_title = variant_title;\n                    variantPurchased.title = title\n                }\n            }\n            //Check if transaction has already been made due to faulty webhook\n            const check_params = {\n                TableName: 'Deal_Transactions',\n                FilterExpression: 'order_id = :id and variant_title =:v',\n                ExpressionAttributeValues: { ':id': id, ':v': variant_title.length > 0 ? variant_title : null }\n            }\n            let awsTReq = await docClient.scan(check_params)\n            let tResult = await awsTReq.promise()\n            if (tResult.Items.length > 0) return\n            //Get variant from variant array & add to transaction\n            const t_params = {\n                TableName: 'Deal_Transactions',\n                Item: {\n                    transaction_id, order_id: id, email, shopOrigin: shop,\n                    ...variantPurchased, time_purchased: Date.now(),\n                    v_code: v_code.substring(v_code.length - 5),\n                    time_redeemed: null, rating: null, review: null,\n                    status: 'PURCHASED', vendor: result.Items[0].id\n                }\n            }\n            awsRequest = await docClient.put(t_params);\n            let res = await awsRequest.promise();\n            if (Object.keys(res).length > 0) return false\n            console.log(\"Created Transaction\")\n            let link = `https://scottsdeal.offerware.co/${transaction_id}/redeem/${result.Items[0].id}?shop=${shop}`\n            // Eventually replace variant in email for more targerted content\n            // if (!result.Items[0].email) return //Temporary while developing\n            let sendEmail = result.Items[0].email.replace('{{Auto-Generated Link}}', link)\n            console.log(sendEmail)\n            const msg = {\n                to: email, from: 'scottsdeal@offerware.co',\n                subject: `Your Voucher Link for: ${variant_title}.`,\n                text: sendEmail,\n            }\n            let resMail = await sgMail.send(msg)\n            return true\n        }\n    },\n    updateProductInDB: async (title, handle, shop, descriptionHtml, images, variants) => {\n        console.log(\"UPDATING\")\n        const title_params = {\n            TableName: 'Shopify_Products',\n            FilterExpression: 'shopOrigin = :shop and title = :t',\n            ExpressionAttributeValues: { ':shop': shop, ':t': title }\n        }\n        let awsRequest = docClient.scan(title_params);\n        let result = await awsRequest.promise();\n        let updatedProduct = null;\n        // First check If title did not change & update db if found\n        if (result.Items.length > 0) {\n            updatedProduct = { ...result.Items[0], title, handle, descriptionHtml }\n            await updateDB(updatedProduct, images, variants)\n            return\n        } else { // Check if handle did not change & update db if found\n            const handle_params = {\n                TableName: 'Shopify_Products',\n                FilterExpression: 'shopOrigin = :shop and handle = :h',\n                ExpressionAttributeValues: { ':shop': shop, ':h': handle }\n            }\n            awsRequest = docClient.scan(handle_params);\n            result = await awsRequest.promise();\n            if (result.Items.length > 0)\n                updatedProduct = { ...result.Items[0], title, handle, descriptionHtml }\n            await updateDB(updatedProduct, images, variants)\n            // else do nothing because Shopify Admin did not subscribe\n            // to Voucher capabilities with this products\n            return\n        }\n    },\n}\n\nasync function updateDB(updatedProduct, images, variants) {\n    let newImages = [];\n    for (let image of images)\n        newImages.push({ 'altText': image.alt, 'originalSrc': image.src })\n    updatedProduct.images = newImages;\n    let newVariants = [];\n    for (let variant of variants)\n        newVariants.push({ 'title': variant.title, 'price': variant.price, 'compareAtPrice': variant.compare_at_price })\n    updatedProduct.variants = newVariants\n    let updated_params = {\n        TableName: 'Shopify_Products',\n        Item: updatedProduct\n    }\n    let awsReq = await docClient.put(updated_params);\n    let res = awsReq.promise();\n    return;\n}"]},"metadata":{},"sourceType":"script"}